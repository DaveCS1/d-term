<mahapps:MetroWindow
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:mahapps="http://metro.mahapps.com/winfx/xaml/controls"
	xmlns:mahappsshared="http://metro.mahapps.com/winfx/xaml/shared"
	xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:materialdesign="http://materialdesigninxaml.net/winfx/xaml/themes"
	xmlns:behaviors="clr-namespace:dTerm.UI.Wpf.Behaviors"
	xmlns:wndbase="clr-namespace:System.ComponentModel;assembly=WindowsBase"
	x:Class="dTerm.UI.Wpf.Views.ShellView"
	FontFamily="pack://application:,,,/MaterialDesignThemes.Wpf;component/Resources/Roboto/#Roboto"
	TextElement.Foreground="{DynamicResource MaterialDesignBody}"
	Background="{DynamicResource MaterialDesignPaper}"
	TextOptions.TextFormattingMode="Ideal"
	TextOptions.TextRenderingMode="Auto"
	WindowStartupLocation="CenterScreen"
	TextElement.FontWeight="Regular"
	TextElement.FontSize="13"
	WindowState="Maximized"
	mc:Ignorable="d"
	Title="dTerm" 
	MinHeight="768" 
	MinWidth="1024"
	ShowTitleBar="False"
	x:Name="shellView"
>

	<!--
	<i:Interaction.Triggers>
		<i:EventTrigger EventName="Loaded">
			<ei:CallMethodAction TargetObject="{Binding}" MethodName="Initialize" />
		</i:EventTrigger>
	</i:Interaction.Triggers>
	-->

	<i:Interaction.Behaviors>
		<mahappsshared:BorderlessWindowBehavior/>
		<behaviors:WindowHandleProviderBehavior WindowHandle="{Binding ShellViewHandle, Mode=TwoWay}" />
	</i:Interaction.Behaviors>

	<mahapps:MetroWindow.Resources>

		<Style x:Key="consoleOptionButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignFloatingActionAccentButton}">
			<Setter Property="Margin" Value="7.5 0" />
			<Setter Property="ToolTipService.Placement" Value="Center" />
			<Setter Property="ToolTipService.VerticalOffset" Value="-50" />
			<Setter Property="ToolTipService.InitialShowDelay" Value="750" />
			<Setter Property="ToolTip" Value="{Binding Description}" />
			<Setter Property="IsEnabled" Value="{Binding IsSupported}" />
			<Setter Property="CommandParameter" Value="{Binding}" />
			<Setter Property="Command" Value="{Binding DataContext.CreateConsoleProcessInstanceCommand, ElementName=shellView}" />
		</Style>

		<CollectionViewSource x:Key="consoleOptionsSource" Source="{Binding ConsoleOptions}">
			<CollectionViewSource.SortDescriptions>
				<wndbase:SortDescription PropertyName="DisplayOrder" />
			</CollectionViewSource.SortDescriptions>
			<CollectionViewSource.GroupDescriptions>
				<PropertyGroupDescription PropertyName="IsSupported" />
			</CollectionViewSource.GroupDescriptions>
		</CollectionViewSource>

	</mahapps:MetroWindow.Resources>

	<Grid>

		<!-- Instances -->

		<ScrollViewer>

			<ScrollViewer.Style>
				<Style TargetType="ScrollViewer">
					<Setter Property="Margin" Value="15 135 15 175" />
					<Setter Property="VerticalAlignment" Value="Center" />
					<Setter Property="HorizontalAlignment" Value="Right" />
					<Setter Property="VerticalScrollBarVisibility" Value="Hidden" />
					<Setter Property="HorizontalScrollBarVisibility" Value="Hidden" />
				</Style>
			</ScrollViewer.Style>

			<ItemsControl ItemsSource="{Binding ConsoleInstances}" Width="200">

				<ItemsControl.ItemsPanel>
					<ItemsPanelTemplate>
						<StackPanel />
					</ItemsPanelTemplate>
				</ItemsControl.ItemsPanel>

				<ItemsControl.ItemTemplate>
					<DataTemplate>
						<Border Margin="3.5">
							<materialdesign:Chip HorizontalAlignment="Stretch" VerticalContentAlignment="Center" IsDeletable="True">
								<materialdesign:Chip.Icon>
									<ContentControl Content="{Binding ConsoleType}" />
								</materialdesign:Chip.Icon>
								<materialdesign:Chip.Content>
									<TextBlock Text="{Binding Name}" HorizontalAlignment="Stretch" TextAlignment="Center" />
								</materialdesign:Chip.Content>
							</materialdesign:Chip>
						</Border>
					</DataTemplate>
				</ItemsControl.ItemTemplate>

			</ItemsControl>

		</ScrollViewer>

		<Grid>

			<Grid.Style>
				<Style TargetType="Grid">
					<Setter Property="Margin" Value="15 0 15 15" />
					<Setter Property="VerticalAlignment" Value="Bottom" />
				</Style>
			</Grid.Style>

			<!-- Line -->

			<Separator>
				<Separator.Style>
					<Style TargetType="Separator">
						<Setter Property="Height" Value="5" />
						<Setter Property="Background" Value="Black" />
						<Setter Property="BorderBrush" Value="Black" />
						<Setter Property="BorderThickness" Value="5" />
						<Setter Property="VerticalAlignment" Value="Center" />
						<Setter Property="HorizontalAlignment" Value="Stretch" />
					</Style>
				</Separator.Style>
			</Separator>

			<!-- Console options -->

			<Border>

				<Border.Style>
					<Style TargetType="Border">
						<Setter Property="Margin" Value="75 15" />
						<Setter Property="VerticalAlignment" Value="Center" />
						<Setter Property="HorizontalAlignment" Value="Right" />
						<Setter Property="Background" Value="{DynamicResource MaterialDesignPaper}" />
					</Style>
				</Border.Style>

				<ItemsControl ItemsSource="{Binding Source={StaticResource consoleOptionsSource}}">

					<ItemsControl.ItemsPanel>
						<ItemsPanelTemplate>
							<StackPanel Margin="15 0" Orientation="Horizontal" />
						</ItemsPanelTemplate>
					</ItemsControl.ItemsPanel>

					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Button Style="{DynamicResource consoleOptionButtonStyle}">
								<ContentControl Content="{Binding ConsoleType}" />
							</Button>
						</DataTemplate>
					</ItemsControl.ItemTemplate>

				</ItemsControl>

			</Border>

		</Grid>

		<Ellipse Style="{DynamicResource logoMaskStyle}" />

		<Path Style="{DynamicResource logoVisualStyle}" />

	</Grid>

</mahapps:MetroWindow>
