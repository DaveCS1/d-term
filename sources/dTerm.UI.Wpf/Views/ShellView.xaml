<mahapps:MetroWindow
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:dterm="clr-namespace:dTerm.Core;assembly=Sarto.dTerm.Core"
	xmlns:mahapps="http://metro.mahapps.com/winfx/xaml/controls"
	xmlns:materialdesign="http://materialdesigninxaml.net/winfx/xaml/themes"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:wndbase="clr-namespace:System.ComponentModel;assembly=WindowsBase"
	xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
	x:Class="dTerm.UI.Wpf.Views.ShellView"
	FontFamily="pack://application:,,,/MaterialDesignThemes.Wpf;component/Resources/Roboto/#Roboto"
	TextElement.Foreground="{DynamicResource MaterialDesignBody}"
	Background="{DynamicResource MaterialDesignPaper}"
	TextOptions.TextFormattingMode="Ideal"
	TextOptions.TextRenderingMode="Auto"
	WindowStartupLocation="CenterScreen"
	TextElement.FontWeight="Regular"
	TextElement.FontSize="13"
	WindowState="Maximized"
	mc:Ignorable="d"
	Title="wTerm" 
	MinHeight="768" 
	MinWidth="1024"
	ShowTitleBar="False"
	x:Name="shellView"
>

	<!--
	<i:Interaction.Triggers>
		<i:EventTrigger EventName="Loaded">
			<ei:CallMethodAction TargetObject="{Binding}" MethodName="Initialize" />
		</i:EventTrigger>
	</i:Interaction.Triggers>
	-->

	<mahapps:MetroWindow.Resources>

		<Style x:Key="primaryButtonsContainerLineStyle" TargetType="{x:Type Separator}">
			<Setter Property="Height" Value="5" />
			<Setter Property="Background" Value="Black" />
			<Setter Property="BorderBrush" Value="Black" />
			<Setter Property="BorderThickness" Value="5" />
			<Setter Property="VerticalAlignment" Value="Center" />
			<Setter Property="HorizontalAlignment" Value="Stretch" />
		</Style>

		<Style x:Key="primaryButtonsContainerWrapperStyle" TargetType="{x:Type Border}">
			<Setter Property="Margin" Value="75 15" />
			<Setter Property="VerticalAlignment" Value="Center" />
			<Setter Property="HorizontalAlignment" Value="Right" />
			<Setter Property="Background" Value="{DynamicResource MaterialDesignPaper}" />
		</Style>

		<Style x:Key="processTabsStyle" BasedOn="{StaticResource {x:Type TabControl}}" TargetType="{x:Type TabControl}">
			<Setter Property="Margin" Value="35 35 35 35" />
			<Setter Property="Grid.Column" Value="1" />
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="IsSynchronizedWithCurrentItem" Value="True" />
			<Setter Property="HorizontalAlignment" Value="Stretch" />
			<Setter Property="VerticalAlignment" Value="Stretch" />
			<Setter Property="TabStripPlacement" Value="Right" />
			<Setter Property="ItemsSource" Value="{Binding Consoles}" />
			<Setter Property="SelectedValue" Value="{Binding SelectedConsole}" />
			<Setter Property="ItemContainerStyle">
				<Setter.Value>
					<Style BasedOn="{StaticResource {x:Type TabItem}}" TargetType="{x:Type TabItem}">
						<EventSetter Event="ButtonBase.Click" Handler="TabItem_Click" />
					</Style>
				</Setter.Value>
			</Setter>
		</Style>

		<CollectionViewSource x:Key="consoleOptionsSource" Source="{Binding ConsoleOptions}">
			<CollectionViewSource.SortDescriptions>
				<wndbase:SortDescription PropertyName="DisplayOrder" />
			</CollectionViewSource.SortDescriptions>
			<CollectionViewSource.GroupDescriptions>
				<PropertyGroupDescription PropertyName="IsSupported" />
			</CollectionViewSource.GroupDescriptions>
		</CollectionViewSource>

	</mahapps:MetroWindow.Resources>

	<Grid>

		<Grid>

			<Grid.RowDefinitions>
				<RowDefinition Height="*" />
				<RowDefinition Height="Auto" />
			</Grid.RowDefinitions>

			<Grid>

				<TabControl Style="{DynamicResource processTabsStyle}">

					<TabControl.Resources>
						<Style TargetType="{x:Type TabPanel}">
							<Setter Property="Margin" Value="35 15 15 15"/>
							<Setter Property="VerticalAlignment" Value="Center"/>
							<Setter Property="HorizontalAlignment" Value="Center"/>
						</Style>
					</TabControl.Resources>

					<TabControl.ItemTemplate>
						<DataTemplate>
							<materialdesign:Chip Margin="0 3.5" Content="{Binding Name}">
								<materialdesign:Chip.Icon>
									<materialdesign:PackIcon Kind="Console"/>
								</materialdesign:Chip.Icon>
							</materialdesign:Chip>
						</DataTemplate>
					</TabControl.ItemTemplate>

				</TabControl>

			</Grid>

			<Grid Grid.Row="1" Margin="15 0 0 15">

				<Separator Style="{DynamicResource primaryButtonsContainerLineStyle}" />

				<Border Style="{DynamicResource primaryButtonsContainerWrapperStyle}">

					<ItemsControl ItemsSource="{Binding Source={StaticResource consoleOptionsSource}}">

						<ItemsControl.ItemsPanel>
							<ItemsPanelTemplate>
								<StackPanel Margin="15 0" Orientation="Horizontal" />
							</ItemsPanelTemplate>
						</ItemsControl.ItemsPanel>

						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<Button ToolTip="{Binding Description}" Command="{Binding DataContext.CreateConsoleProcessInstanceCommand, ElementName=shellView}" IsEnabled="{Binding IsSupported}" CommandParameter="{Binding}" Style="{DynamicResource consoleOptionButtonStyle}" />
							</DataTemplate>
						</ItemsControl.ItemTemplate>

					</ItemsControl>

				</Border>

			</Grid>

		</Grid>

		<Ellipse Style="{DynamicResource logoMaskStyle}" />

		<Path Style="{DynamicResource logoVisualStyle}" />

	</Grid>

</mahapps:MetroWindow>
