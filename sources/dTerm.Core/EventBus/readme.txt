Based on the original implementation by Udi Dahan

http://udidahan.com/2009/06/14/domain-events-salvation/